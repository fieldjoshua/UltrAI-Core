import{j as e}from"./ui-vendor-D6E6Lg3s.js";import{a as l}from"./react-vendor-B5BC_0HN.js";const j=({correlationId:p,title:y="Live Orchestrator Events",maxEvents:o=100})=>{const[u,i]=l.useState([]),[m,d]=l.useState("connecting"),g=l.useRef(null),h=l.useMemo(()=>"http://localhost:8000/api",[]);return l.useEffect(()=>{const t=String(p||"").replace(/[^a-zA-Z0-9_\-]/g,"");if(!t){d("error");return}const x=`${h}/orchestrator/events?correlation_id=${encodeURIComponent(t)}`,a=new EventSource(x,{withCredentials:!1});return g.current=a,a.onopen=()=>d("open"),a.onerror=()=>d("error"),a.onmessage=r=>{try{const s=JSON.parse(r.data),n=s&&s.event||"message";i(c=>[{time:new Date().toISOString(),event:n,payload:s},...c].slice(0,o))}catch{i(n=>[{time:new Date().toISOString(),event:"message",payload:r.data},...n].slice(0,o))}},["connected","analysis_start","initial_start","model_selected","model_completed","pipeline_complete","service_unavailable"].forEach(r=>{a.addEventListener(r,s=>{try{const n=JSON.parse(s.data);i(c=>[{time:new Date().toISOString(),event:r,payload:n},...c].slice(0,o))}catch{i(c=>[{time:new Date().toISOString(),event:r,payload:s.data},...c].slice(0,o))}})}),()=>{d("closed");try{a.close()}catch{}g.current=null}},[h,p,o]),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"px-4 py-2 border-b flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-800",children:y}),e.jsx("div",{className:`text-xs ${m==="open"?"text-green-600":m==="error"?"text-red-600":"text-gray-500"}`,children:m})]}),e.jsx("div",{className:"p-3 max-h-64 overflow-auto text-xs font-mono leading-snug",children:u.length===0?e.jsxs("div",{className:"text-gray-500",children:["Waiting for events on correlation_id: ",p]}):e.jsx("ul",{className:"space-y-2",children:u.map((t,x)=>e.jsxs("li",{className:"border-b pb-2",children:[e.jsxs("div",{className:"text-gray-600",children:["[",t.time,"]"," ",e.jsx("span",{className:"font-semibold text-gray-800",children:t.event})]}),e.jsx("pre",{className:"whitespace-pre-wrap break-words text-gray-800",children:typeof t.payload=="string"?t.payload:JSON.stringify(t.payload,null,2)})]},x))})})]})};export{j as default};
//# sourceMappingURL=SSEPanel-B0roH9S8.js.map
