# Report Artifacts Documentation

Index of all test reports, coverage data, and build artifacts generated by the UltrAI project.

## Overview

This document catalogs output files from testing, linting, coverage, and CI/CD processes. Each section includes commands to generate artifacts and their output paths.

---

## Backend Artifacts (Python)

### 1. Pytest Test Reports

**Command:**
```bash
pytest -v --tb=short
```

**Output Locations:**
- **Console:** Terminal output with pass/fail summary
- **HTML Report:** `htmlcov/index.html` (if using `--cov-report=html`)
- **JUnit XML:** `reports/pytest-junit.xml` (if configured in pytest.ini)

**Generated By:**
- `pytest.ini` configuration
- `.github/workflows/` CI configuration (if present)

**Example Output:**
```
tests/unit/test_output_formatter.py::test_format_pipeline_output_structure PASSED
tests/integration/test_sse_events.py::test_sse_heartbeat_frames PASSED
======================== 12 passed, 2 warnings in 0.14s ========================
```

---

### 2. Coverage Reports

**Command:**
```bash
pytest --cov=app --cov-report=html --cov-report=term
```

**Output Locations:**
- **HTML Report:** `htmlcov/index.html`
- **Terminal:** Coverage summary in console
- **Coverage Data:** `.coverage` (binary file)
- **XML (CI):** `coverage.xml` (for Codecov, Coveralls)

**How to View:**
```bash
open htmlcov/index.html  # macOS
xdg-open htmlcov/index.html  # Linux
```

**Example Summary:**
```
----------- coverage: platform darwin, python 3.13.5-final-0 -----------
Name                                 Stmts   Miss  Cover
--------------------------------------------------------
app/services/output_formatter.py       125      8    94%
app/services/sse_event_bus.py           45      3    93%
app/routes/orchestrator_minimal.py     385     45    88%
--------------------------------------------------------
TOTAL                                 1250    120    90%
```

---

### 3. Snapshots

**Location:** `tests/__snapshots__/`

**Files:**
- `output_formatter_full_document.txt` - OutputFormatter full_document snapshot

**Purpose:** Visual validation of formatted output structure

**Update Command:**
```bash
pytest tests/unit/test_output_formatter.py::test_full_document_snapshot
```

---

### 4. Linting Reports (Ruff)

**Command:**
```bash
ruff check . --output-format=json > reports/ruff-report.json
```

**Output Locations:**
- **Console:** Terminal output with violations
- **JSON:** `reports/ruff-report.json` (structured data)

**Example Output:**
```json
[
  {
    "code": "F401",
    "message": "'app.models.User' imported but unused",
    "location": {
      "file": "app/routes/auth.py",
      "row": 5,
      "column": 1
    }
  }
]
```

**Check Only (No Output Files):**
```bash
ruff check .
```

---

### 5. Type Checking (MyPy, if configured)

**Command:**
```bash
mypy app/ --html-report mypy-report/
```

**Output Locations:**
- **HTML Report:** `mypy-report/index.html`
- **Terminal:** Type errors in console

---

## Frontend Artifacts (Jest)

### 1. Jest Test Reports

**Command:**
```bash
npm test -- --coverage
```

**Output Locations:**
- **Console:** Terminal output with pass/fail summary
- **HTML Report:** `coverage/lcov-report/index.html`
- **JSON:** `coverage/coverage-final.json`
- **LCOV:** `coverage/lcov.info` (for CI integrations)

**Example Output:**
```
PASS  src/components/__tests__/ResultsDisplay.test.tsx
PASS  src/components/panels/__tests__/SSEPanel.test.tsx

Test Suites: 2 passed, 2 total
Tests:       24 passed, 24 total
Snapshots:   0 total
Time:        2.451 s
```

---

### 2. Coverage Reports

**Command:**
```bash
npm test -- --coverage --coverageReporters=html --coverageReporters=text
```

**Output Locations:**
- **HTML Report:** `frontend/coverage/lcov-report/index.html`
- **Terminal:** Coverage summary in console
- **LCOV:** `frontend/coverage/lcov.info`

**How to View:**
```bash
cd frontend
open coverage/lcov-report/index.html
```

**Example Summary:**
```
-----------------------------|---------|----------|---------|---------|-------------------
File                         | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
-----------------------------|---------|----------|---------|---------|-------------------
All files                    |   78.52 |    71.43 |   82.35 |   78.92 |
 components                  |   85.71 |    80.00 |   90.00 |   85.71 |
  OrchestratorInterface.jsx  |   85.71 |    80.00 |   90.00 |   85.71 | 234-245,567
 panels                      |   72.22 |    66.67 |   75.00 |   73.33 |
  SSEPanel.tsx               |   72.22 |    66.67 |   75.00 |   73.33 | 45-52,89-94
-----------------------------|---------|----------|---------|---------|-------------------
```

---

### 3. Storybook Build

**Command:**
```bash
npm run build-storybook
```

**Output Location:**
- **Static Files:** `frontend/storybook-static/`

**How to View:**
```bash
cd frontend
npx serve storybook-static
```

**Purpose:** Static documentation of UI components with interactive examples

---

### 4. Linting Reports (ESLint)

**Command:**
```bash
npm run lint -- --format json --output-file reports/eslint-report.json
```

**Output Locations:**
- **Console:** Terminal output with violations
- **JSON:** `frontend/reports/eslint-report.json`

**Example Output:**
```json
[
  {
    "filePath": "src/components/OrchestratorInterface.jsx",
    "messages": [
      {
        "ruleId": "no-unused-vars",
        "severity": 2,
        "message": "'useState' is defined but never used.",
        "line": 12,
        "column": 8
      }
    ]
  }
]
```

---

### 5. Build Artifacts

**Command:**
```bash
npm run build
```

**Output Location:**
- **Production Build:** `frontend/dist/`

**Contents:**
- `dist/index.html` - Entry point
- `dist/assets/` - JS/CSS bundles
- `dist/public/` - Static assets

**Size Report:**
```
dist/assets/index-abc123.js     245.67 kB
dist/assets/vendor-def456.js    512.34 kB
dist/assets/index-abc123.css     45.21 kB
```

---

## Schema & Contract Artifacts

### 1. JSON Schema

**Location:** `docs/analysis_response.schema.json`

**Purpose:** Contract definition for AnalysisResponse model

**Validation Command:**
```bash
python scripts/validate_schema.py reports/samples/analysis_response_simple.json
```

---

### 2. Sample Responses

**Location:** `reports/samples/`

**Files:**
- `analysis_response_simple.json` - Simple mode response
- `analysis_response_detailed.json` - Detailed mode response
- `analysis_response_error.json` - Error response

**Purpose:** Reference implementations for frontend/backend contract

---

### 3. Frontend Fixtures

**Location:** `frontend/src/__fixtures__/orchestration/`

**Files:**
- `simple.json` - Simple mode fixture for tests
- `detailed.json` - Detailed mode fixture for tests
- `error.json` - Error state fixture for tests

**Purpose:** Mock data for frontend unit tests

---

## CI/CD Artifacts (GitHub Actions, if configured)

### 1. Workflow Run Logs

**Location:** GitHub Actions UI (web)

**Artifacts Uploaded:**
- Test reports (JUnit XML)
- Coverage reports (coverage.xml)
- Build artifacts (dist/, storybook-static/)

**Download Command (GitHub CLI):**
```bash
gh run download <run-id> --name test-results
```

---

### 2. Docker Build Logs

**Command:**
```bash
docker build -t ultrai:latest . > reports/docker-build.log 2>&1
```

**Output Location:** `reports/docker-build.log`

---

## Local Development Artifacts

### 1. Development Logs

**Backend:**
```bash
make dev > logs/dev-backend.log 2>&1
```

**Frontend:**
```bash
npm run dev > logs/dev-frontend.log 2>&1
```

**Output Locations:**
- `logs/dev-backend.log`
- `logs/dev-frontend.log`

---

### 2. Database Snapshots

**Location:** `backups/` (if configured)

**Generate:**
```bash
pg_dump ultrai_db > backups/ultrai_$(date +%Y%m%d).sql
```

---

### 3. Performance Profiles

**Backend (cProfile):**
```bash
python -m cProfile -o reports/profile.stats app_production.py
```

**Frontend (Lighthouse):**
```bash
lighthouse http://localhost:3009 --output html --output-path reports/lighthouse.html
```

**Output Locations:**
- `reports/profile.stats` (Python profiler)
- `reports/lighthouse.html` (Lighthouse report)

---

## Report Generation Commands Summary

### Backend

```bash
# Run tests with coverage
pytest --cov=app --cov-report=html --cov-report=term

# Generate lint report
ruff check . --output-format=json > reports/ruff-report.json

# Run all tests with verbose output
pytest -v --tb=short
```

### Frontend

```bash
# Run tests with coverage
npm test -- --coverage

# Generate lint report
npm run lint -- --format json --output-file reports/eslint-report.json

# Build production artifacts
npm run build

# Build Storybook
npm run build-storybook
```

### Combined (Full CI Simulation)

```bash
# Backend
pytest --cov=app --cov-report=html --cov-report=xml
ruff check .

# Frontend
cd frontend
npm test -- --coverage
npm run lint
npm run build
cd ..
```

---

## Artifact Cleanup

### Remove All Generated Artifacts

```bash
# Backend
rm -rf htmlcov/ .coverage coverage.xml .pytest_cache/

# Frontend
rm -rf frontend/coverage/ frontend/dist/ frontend/storybook-static/ frontend/node_modules/.cache/

# Logs
rm -rf logs/ reports/

# Snapshots (careful, may need to regenerate)
# rm -rf tests/__snapshots__/
```

---

## Viewing Reports Locally

### HTML Reports

```bash
# Backend coverage
open htmlcov/index.html

# Frontend coverage
open frontend/coverage/lcov-report/index.html

# Storybook
cd frontend && npx serve storybook-static
```

### JSON Reports (for programmatic access)

```bash
# Backend lint
cat reports/ruff-report.json | jq '.'

# Frontend lint
cat frontend/reports/eslint-report.json | jq '.'

# Frontend coverage
cat frontend/coverage/coverage-final.json | jq '.total'
```

---

## Related Documentation

- `CLAUDE.md` - Testing commands and project structure
- `pytest.ini` - Pytest configuration
- `frontend/jest.config.js` - Jest configuration
- `.github/workflows/` - CI pipeline definitions (if present)

---

## Maintenance

**Update Frequency:** 
- Snapshots: On schema/format changes
- Sample JSONs: When AnalysisResponse structure changes
- Reports: Generated on every test run (ephemeral)

**Ownership:**
- Backend artifacts: Maintained by backend developers
- Frontend artifacts: Maintained by frontend developers
- Schema/samples: Shared responsibility, version controlled

**Storage:**
- **Version Controlled:** Snapshots, sample JSONs, schemas
- **Ignored (.gitignore):** Coverage reports, build artifacts, logs
- **CI Artifacts:** Uploaded to GitHub Actions (30-day retention)
