# Render configuration for PRODUCTION environment
# Service: ultrai-prod-api.onrender.com

services:
  - type: web
    name: ultrai-prod-api
    runtime: python
    plan: free  # Consider upgrading for production
    buildCommand: pip install -r requirements-production.txt
    startCommand: python app_production.py
    
    # Auto-deploy enabled temporarily for LLM health fix
    branch: main
    autoDeploy: true  # TODO: Set back to false after fix is deployed
    
    # Health check
    healthCheckPath: /api/health
    
    envVars:
      # Core configuration
      - key: ENVIRONMENT
        value: production
      - key: DEBUG
        value: "false"
      
      # Enable production features
      - key: ENABLE_BILLING
        value: "false"  # Enable when ready
      - key: ENABLE_PRICING
        value: "false"  # Enable when ready
      - key: ENABLE_AUTH
        value: "true"
      - key: ENABLE_RATE_LIMIT
        value: "true"
      
      # Security
      - key: JWT_SECRET
        generateValue: true
      - key: JWT_REFRESH_SECRET
        generateValue: true
      
      # LLM API Keys (set in dashboard)
      - key: OPENAI_API_KEY
        sync: false
      - key: ANTHROPIC_API_KEY
        sync: false
      - key: GOOGLE_API_KEY
        sync: false
      - key: HUGGINGFACE_API_KEY
        sync: false
      
      # Database
      - key: DATABASE_URL
        fromDatabase:
          name: ultrai-prod-db
          property: connectionString
      
      # Redis (if needed)
      - key: REDIS_URL
        sync: false  # Set in dashboard if using Redis
      
      # CORS
      - key: CORS_ORIGINS
        value: "https://ultrai.com,https://www.ultrai.com,https://demo-ultrai.onrender.com,https://ultrai-prod-api.onrender.com"

# Database configuration
databases:
  - name: ultrai-prod-db
    plan: free
    databaseName: ultrai_production
    user: ultrai_prod_user
    postgresMajorVersion: "15"